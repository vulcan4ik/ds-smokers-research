# üö¨ Smokers Classification

> –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤ –ø–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º —Å –ø–æ–º–æ—â—å—é CatBoost  
> **Kaggle Leopard Challenge | Place: 15 | Score: 0.44613**  
> **F1-score: 0.4375 | ROC-AUC: 0.7187 | Recall: 57% | 19 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ + 5-Fold CV**

[![Kaggle](https://img.shields.io/badge/Kaggle-Competition%2015th%20Place-20BEFF?style=flat&logo=kaggle)](https://www.kaggle.com/competitions/leopard-challenge-classification/leaderboard)
[![Score](https://img.shields.io/badge/Kaggle%20Score-0.44613-3DDC84?style=flat)]()
[![Python](https://img.shields.io/badge/Python-3.11-blue.svg)](https://www.python.org/)
[![CatBoost](https://img.shields.io/badge/CatBoost-Gradient%20Boosting-orange.svg)](https://catboost.ai/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Status](https://img.shields.io/badge/Status-Production%20Ready-brightgreen.svg)]()

---

## üèÜ –£—á–∞—Å—Ç–∏–µ –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏

**ü•á Kaggle Leopard Challenge Classification**
- üìç **–ú–µ—Å—Ç–æ:** 15 –∏–∑ ~500 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- üéØ **Kaggle Score:** 0.44613 (F1-score)
- üìä **–î–∞—Ç–∞—Å–µ—Ç:** –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤
- üîó **Leaderboard:** [Kaggle Competition](https://www.kaggle.com/competitions/leopard-challenge-classification/leaderboard)

### –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏—è –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏

```
üöÄ –ó–∞–ø—É—Å–∫                              v1: 0.1279 ‚ùå –û—á–µ–Ω—å –Ω–∏–∑–∫–æ
  ‚Üì
‚öñÔ∏è –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤              v2: 0.3525 ‚ö†Ô∏è  –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
  ‚Üì
üéØ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞                 v3: 0.4487 ‚úÖ –ü—Ä–æ—Ä—ã–≤!
  ‚Üì
üîß Feature Engineering                v4: 0.4494 ‚ûï –ú–∏–Ω–∏–º—É–º
  ‚Üì
‚úîÔ∏è 5-Fold Cross-Validation            v5: 0.4345 üìä –ù–∞–¥–µ–∂–Ω–æ
  ‚Üì
üèÜ –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ Kaggle       v6: 0.44613 üéñÔ∏è 15 –º–µ—Å—Ç–æ
```

---

## üìå –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è **–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∫—É—Ä–µ–Ω–∏—è** —á–µ–ª–æ–≤–µ–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏ –±–∏–æ—Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ —Ä–∞–º–∫–∞—Ö **Kaggle —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è "Leopard Challenge"**.

–ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **CatBoost** ‚Äî –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ä–∞–±–æ—Ç–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

**–ö–ª—é—á–µ–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç **57% –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤** —Å –ø—Ä–∏–µ–º–ª–µ–º—ã–º —É—Ä–æ–≤–Ω–µ–º —Ç–æ—á–Ω–æ—Å—Ç–∏ (F1=0.44), —á—Ç–æ –ø–æ–¥–Ω—è–ª–æ—Å—å –Ω–∞ **15-–µ –º–µ—Å—Ç–æ** –≤ Kaggle —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏.

---

## üéØ –ó–∞–¥–∞—á–∞

**–ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- ‚úÖ **–ö–ª–∞—Å—Å 1:** –ß–µ–ª–æ–≤–µ–∫ –∫—É—Ä–∏—Ç
- ‚ùå **–ö–ª–∞—Å—Å 0:** –ß–µ–ª–æ–≤–µ–∫ –Ω–µ –∫—É—Ä–∏—Ç

**–î–∞–Ω–Ω—ã–µ:** 26 –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ + —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è  
**–î–∏—Å–±–∞–ª–∞–Ω—Å:** ~80% –Ω–µ–∫—É—Ä—è—â–∏—Ö vs ~20% –∫—É—Ä—è—â–∏—Ö  
**–†–∞–∑–º–µ—Ä:** ~3500 –æ–±—É—á–∞—é—â–∏—Ö + ~1500 —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤

---

## üìä –î–∞—Ç–∞—Å–µ—Ç

**–ò—Å—Ç–æ—á–Ω–∏–∫:** [Kaggle Leopard Challenge](https://www.kaggle.com/competitions/leopard-challenge-classification)  
**–†–∞–∑–º–µ—Ä:** ~3500 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (train) + ~1500 (test)

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü—Ä–∏–∑–Ω–∞–∫–∏ |
|-----------|----------|
| üë§ **–î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ** | age |
| üìè **–ê–Ω—Ç—Ä–æ–ø–æ–º–µ—Ç—Ä–∏—è** | height(cm), weight(kg), waist(cm) |
| üíâ **–ë–∏–æ—Ö–∏–º–∏—è** | triglyceride, cholesterol, HDL, LDL, hemoglobin, fasting_blood_sugar |
| üè• **–§–µ—Ä–º–µ–Ω—Ç—ã –ø–µ—á–µ–Ω–∏** | AST, ALT, GTP, serum_creatinine |
| ü©∫ **–ö–∞—Ä–¥–∏–æ–≤–∞—Å–∫—É–ª—è—Ä–Ω—ã–µ** | systolic, relaxation (–¥–∞–≤–ª–µ–Ω–∏–µ) |
| üëÅÔ∏èüëÇ **–°–µ–Ω—Å–æ—Ä–Ω—ã–µ** | eyesight(left/right), hearing(left/right) |
| ü¶∑ **–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ** | dental_caries, tartar |

---

## üî¨ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è

### 1Ô∏è‚É£ **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (EDA)**

```python
# –ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤
smoking_dist = train['smoking'].value_counts()
# 0: 2852 (80.4%)
# 1: 694  (19.6%)

# –î–∏—Å–±–∞–ª–∞–Ω—Å: 1:4.1 - —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

**–í—ã–≤–æ–¥:** –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å —Ç—Ä–µ–±—É–µ—Ç:
- ‚úÖ Stratified K-Fold
- ‚úÖ auto_class_weights='Balanced'
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞

### 2Ô∏è‚É£ **Feature Engineering** (19 –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)

```python
# –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏–Ω–¥–µ–∫—Å—ã
bmi = weight / (height/100)¬≤                    # –ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞
waist_height_ratio = waist / height             # –ê–±–¥–æ–º–∏–Ω–∞–ª—å–Ω–æ–µ –æ–∂–∏—Ä–µ–Ω–∏–µ

# –ö–∞—Ä–¥–∏–æ–≤–∞—Å–∫—É–ª—è—Ä–Ω—ã–µ
pulse_pressure = systolic - relaxation          # –ñ–µ—Å—Ç–∫–æ—Å—Ç—å –∞—Ä—Ç–µ—Ä–∏–π

# –õ–∏–ø–∏–¥–Ω—ã–π –æ–±–º–µ–Ω (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∞—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑–∞)
ldl_hdl_ratio = LDL / HDL                       # –ü–ª–æ—Ö–æ–π/–•–æ—Ä–æ—à–∏–π —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω
trig_hdl_ratio = triglyceride / HDL             # –¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã/–•–æ—Ä–æ—à–∏–π
atherogenic_index = (Chol - HDL) / HDL          # –ê—Ç–µ—Ä–æ–≥–µ–Ω–Ω—ã–π –∏–Ω–¥–µ–∫—Å

# –ü–µ—á–µ–Ω–æ—á–Ω—ã–µ —Ñ–µ—Ä–º–µ–Ω—Ç—ã (–æ–∫–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç—Ä–µ—Å—Å)
ast_alt_ratio = AST / ALT                       # De Ritis Ratio
liver_enzyme_sum = AST + ALT + GTP              # –°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
log_gtp = log(GTP + 1)                          # –õ–æ–≥–∞—Ä–∏—Ñ–º (–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è)

# –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã)
age_bmi_interaction = age √ó BMI                 # –í–æ–∑—Ä–∞—Å—Ç √ó –û–∂–∏—Ä–µ–Ω–∏–µ
age_gtp_interaction = age √ó GTP                 # –ù–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** +0.7% —É–ª—É—á—à–µ–Ω–∏–µ F1-score ‚Üí **0.4494**

### 3Ô∏è‚É£ **–ú–æ–¥–µ–ª—å: CatBoost Classifier**

**–ü–æ—á–µ–º—É CatBoost?**
- ‚úÖ Native support –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –æ–±—É—á–µ–Ω–∏–µ

**–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

```python
{
    "iterations": 2500,              # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤
    "learning_rate": 0.0075,         # –ù–∏–∑–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å = –ª—É—á—à–µ–µ –æ–±–æ–±—â–µ–Ω–∏–µ
    "depth": 7,                      # –ì–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤
    "l2_leaf_reg": 5.0,              # L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
    "random_strength": 2.0,          # –°—Ç–æ—Ö–∞—Å—Ç–∏—á–Ω–æ—Å—Ç—å
    "bagging_temperature": 0.3,      # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±—ç–≥–≥–∏–Ω–≥–∞
    "border_count": 254,             # –¢–æ–Ω–∫–∏–µ –∫–≤–∞–Ω—Ç–∏–∑–∞—Ü–∏–∏
    "auto_class_weights": "Balanced",# –ö–†–ò–¢–ò–ß–ù–û –¥–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞!
    "eval_metric": "AUC",            # –ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è —Ä–∞–Ω–Ω–µ–≥–æ —Å—Ç–æ–ø–∞
    "early_stopping_rounds": 200,    # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –µ—Å–ª–∏ –Ω–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π
    "random_state": 42
}
```

### 4Ô∏è‚É£ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞** (–≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ä—ã–≤!)

```python
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä–æ–≥: 0.5
y_pred = (y_proba >= 0.5).astype(int)
f1_old = 0.4182

# –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥: 0.491 (–∏–∑ CV)
y_pred = (y_proba >= 0.491).astype(int)
f1_new = 0.4487  # +3.05% —É–ª—É—á—à–µ–Ω–∏–µ!
```

**–ú–µ—Ç–æ–¥:** precision_recall_curve –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º—É–º–∞ –ø–æ F1-score  
**–í–∫–ª–∞–¥:** –≠—Ç–æ –¥–∞–ª–æ **+3.2% —É–ª—É—á—à–µ–Ω–∏—è F1-score!**

### 5Ô∏è‚É£ **–í–∞–ª–∏–¥–∞—Ü–∏—è: 5-Fold Stratified CV**

```python
StratifiedKFold(n_splits=5, shuffle=True, random_state=42)

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ñ–æ–ª–¥–∞–º:
# Fold 1: F1=0.4412, threshold=0.489
# Fold 2: F1=0.4568, threshold=0.493
# Fold 3: F1=0.4156, threshold=0.495
# Fold 4: F1=0.4287, threshold=0.485
# Fold 5: F1=0.4263, threshold=0.489
#
# Mean F1: 0.4345 ¬± 0.013 (CV F1-score)
# Median threshold: 0.491
# ROC-AUC: 0.7099
```

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏)

| –ú–µ—Ç—Ä–∏–∫–∞ | CV (Mean) | Kaggle | –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è |
|---------|-----------|--------|---------------|
| **F1-score** | 0.4345 ¬± 0.013 | **0.44613** | –°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ |
| **Accuracy** | 0.6971 | - | ~70% –≤—Å–µ—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤–µ—Ä–Ω—ã |
| **Precision** | 0.3487 | - | –ò–∑ 100 –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö "–∫—É—Ä–∏—Ç" - 35 –≤–µ—Ä–Ω—ã |
| **Recall** | 0.5763 | - | –ù–∞—Ö–æ–¥–∏–º 57% –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤ |
| **ROC-AUC** | 0.7099 | - | –•–æ—Ä–æ—à–∞—è –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏—è |
| **Threshold** | 0.491 | 0.491 | –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–ª—è F1 |

### üèÜ –ü–æ–∑–∏—Ü–∏—è –≤ Kaggle

```
üìä Leaderboard Ranking

#1   |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 0.53
#5   |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 0.50
#10  |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà     | 0.47
#15  |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà      | 0.44613  ‚Üê –í–´ –ó–î–ï–°–¨
#20  |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà       | 0.44
```

### üîù –¢–æ–ø-10 –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

| # | –ü—Ä–∏–∑–Ω–∞–∫ | –í–∞–∂–Ω–æ—Å—Ç—å | –û–±—ä—è—Å–Ω–µ–Ω–∏–µ |
|---|---------|----------|-----------|
| 1 | **hemoglobin** | 8.83% | –ì–µ–º–æ–≥–ª–æ–±–∏–Ω ‚Üë —É –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤ |
| 2 | **triglyceride** | 7.15% | –¢—Ä–∏–≥–ª–∏—Ü–µ—Ä–∏–¥—ã ‚Üë (–º–µ—Ç–∞–±–æ–ª–∏–∑–º) |
| 3 | **age_bmi_interaction** | 7.03% | –í–æ–∑—Ä–∞—Å—Ç √ó –æ–∂–∏—Ä–µ–Ω–∏–µ |
| 4 | **gtp** | 6.84% | –ì–¢–ü ‚Üë (–ø–µ—á–µ–Ω—å) |
| 5 | **age** | 6.72% | –í–æ–∑—Ä–∞—Å—Ç |
| 6 | **log_gtp** | 6.66% | –õ–æ–≥–∞—Ä–∏—Ñ–º –ì–¢–ü |
| 7 | **ldl** | 6.48% | –õ–∏–ø–æ–ø—Ä–æ—Ç–µ–∏–Ω—ã –Ω–∏–∑–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ |
| 8 | **systolic** | 6.37% | –°–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ ‚Üë |
| 9 | **alt** | 6.31% | –ê–õ–¢ (–ø–µ—á–µ–Ω–æ—á–Ω—ã–π —Ñ–µ—Ä–º–µ–Ω—Ç) |
| 10 | **fasting_blood_sugar** | 6.15% | –°–∞—Ö–∞—Ä –Ω–∞—Ç–æ—â–∞–∫ |

**–í—ã–≤–æ–¥:** –í–æ–∑—Ä–∞—Å—Ç, –±–∏–æ—Ö–∏–º–∏—è, –ø–µ—á–µ–Ω–æ—á–Ω—ã–µ —Ñ–µ—Ä–º–µ–Ω—Ç—ã, –ª–∏–ø–∏–¥—ã - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫—É—Ä–µ–Ω–∏—è

---

## üöÄ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –≠–≤–æ–ª—é—Ü–∏—è –º–æ–¥–µ–ª–∏ ‚Üí Kaggle Score

```
–®–∞–≥ 1: Baseline (14 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îî‚îÄ F1 = 0.1279 (Recall: 7%, Precision: 61%)
‚îî‚îÄ Kaggle: –Ω–∏–∑–∫–∏–π Recall ‚Üí –ø–ª–æ—Ö–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

        ‚Üì –î–æ–±–∞–≤–ª—è–µ–º: auto_class_weights='Balanced'

–®–∞–≥ 2: –° –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π (9 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îî‚îÄ F1 = 0.3525 (Recall: 97%, Precision: 21%)
‚îî‚îÄ Kaggle: —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

        ‚Üì –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –ø–æ—Ä–æ–≥: 0.5 ‚Üí 0.491

–®–∞–≥ 3: –° –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º (11 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îî‚îÄ F1 = 0.4487 (Recall: 54%, Precision: 38%)
‚îî‚îÄ Kaggle: 0.42-0.43 (–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ!)

        ‚Üì –î–æ–±–∞–≤–ª—è–µ–º 19 engineered –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–®–∞–≥ 4: –° feature engineering (19 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
‚îî‚îÄ F1 = 0.4494 (Recall: 56%, Precision: 37%)
‚îî‚îÄ Kaggle: 0.43-0.44

        ‚Üì –§–∏–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ 5-Fold CV

–®–∞–≥ 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å
‚îî‚îÄ F1 = 0.4375 ¬± 0.013 (5-Fold CV)
‚îî‚îÄ Kaggle: 0.44613 ‚úÖ 15-–µ –º–µ—Å—Ç–æ!
```

### üéØ –ì–ª–∞–≤–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ

**ü•á –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–µ–≥–∞ –¥–∞–ª–∞ +3.2% F1-score** ‚Äî –±–æ–ª—å—à–µ, —á–µ–º –≤—Å–µ feature engineering!

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
ds-smokers-research/
‚îÇ
‚îú‚îÄ‚îÄ üìÇ data/
‚îÇ   ‚îú‚îÄ‚îÄ train.csv                 # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (~3546 samples)
‚îÇ   ‚îî‚îÄ‚îÄ test.csv                  # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (~1500 samples)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ ipynb/
‚îÇ   ‚îî‚îÄ‚îÄ smokers-eda-catboost.ipynb # –ü–æ–ª–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å EDA –∏ –º–æ–¥–µ–ª—å—é
‚îÇ
‚îú‚îÄ‚îÄ üìÇ models/
‚îÇ   ‚îî‚îÄ‚îÄ catboost_smokers_final.cbm # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (CatBoost)
‚îÇ
‚îú‚îÄ‚îÄ üìÇ output/
‚îÇ   ‚îú‚îÄ‚îÄ feature_importance.png     # –ì—Ä–∞—Ñ–∏–∫ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ confusion_matrix.png       # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ roc_curve.png              # ROC-AUC –∫—Ä–∏–≤–∞—è
‚îÇ   ‚îú‚îÄ‚îÄ kaggle_submission.csv      # –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ metrics_summary.csv        # –ò—Ç–æ–≥–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ üìÑ README.md                   # –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
‚îî‚îÄ‚îÄ üìÑ requirements.txt            # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
```

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

![Python](https://img.shields.io/badge/Python-3.11-3776AB?style=flat&logo=python&logoColor=white)
![Pandas](https://img.shields.io/badge/Pandas-150458?style=flat&logo=pandas&logoColor=white)
![NumPy](https://img.shields.io/badge/NumPy-013243?style=flat&logo=numpy&logoColor=white)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-F7931E?style=flat&logo=scikit-learn&logoColor=white)
![CatBoost](https://img.shields.io/badge/CatBoost-FFCC00?style=flat)
![Matplotlib](https://img.shields.io/badge/Matplotlib-000000?style=flat)
![Seaborn](https://img.shields.io/badge/Seaborn-3776AB?style=flat)
![Kaggle](https://img.shields.io/badge/Kaggle-20BEFF?style=flat&logo=kaggle)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
git clone https://github.com/vulcan4ik/ds-smokers-research.git
cd ds-smokers-research
pip install -r requirements.txt
```

### 2. –ó–∞–ø—É—Å–∫ notebook

```bash
jupyter lab ipynb/smokers-eda-catboost.ipynb
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

```python
from catboost import CatBoostClassifier
import pandas as pd

# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥–µ–ª—å
model = CatBoostClassifier()
model.load_model("models/catboost_smokers_final.cbm")

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
X_new = pd.read_csv("data/test.csv")
y_proba = model.predict_proba(X_new)[:, 1]  # –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
y_pred = (y_proba >= 0.491).astype(int)     # –° –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –ø–æ—Ä–æ–≥–æ–º
```

### 4. –û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ Kaggle

```python
# –°–æ–∑–¥–∞–Ω–∏–µ submission —Ñ–∞–π–ª–∞
submission = pd.DataFrame({
    'ID': test_data['ID'],
    'smoking': y_pred
})
submission.to_csv('output/kaggle_submission.csv', index=False)

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞ Kaggle leaderboard
```

---

## üìö –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ —Ö–æ—Ä–æ—à–æ

1. **CatBoost —Å auto_class_weights** - –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞
2. **Stratified 5-Fold CV** - —á–µ—Å—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞** - –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —É–ª—É—á—à–µ–Ω–∏—è (+3.2%)
4. **Feature Engineering** - –ø–æ–ª–µ–∑–Ω–æ, –Ω–æ –¥–∞–µ—Ç –º–µ–Ω—å—à–µ, —á–µ–º –ø–æ—Ä–æ–≥
5. **–ù–∏–∑–∫–∞—è learning_rate** - –ª—É—á—à–µ –æ–±–æ–±—â–∞–µ–º–æ—Å—Ç—å

### üéØ –ë–∏–∑–Ω–µ—Å-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

- **Recall 57%:** –ú–æ–¥–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫—É—Ä–∏–ª—å—â–∏–∫–æ–≤ (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞)
- **Precision 35%:** –ú–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π, –Ω–æ –ø—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- **ROC-AUC 0.72:** –ú–æ–¥–µ–ª—å –ª—É—á—à–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ 2.4 —Ä–∞–∑–∞
- **15-–µ –º–µ—Å—Ç–æ –Ω–∞ Kaggle:** –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ—Ç–∏–≤ 500+ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è Precision:** –£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ—Ä–æ–≥ –≤—ã—à–µ 0.491
2. **–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è Recall:** –£–º–µ–Ω—å—à–∏—Ç—å –ø–æ—Ä–æ–≥ –Ω–∏–∂–µ 0.491
3. **–î–ª—è –¥—Ä—É–≥–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `precision_recall_curve` —Å –Ω–æ–≤—ã–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏

---

## üîÆ –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –ê–Ω—Å–∞–º–±–ª—å: XGBoost + LightGBM + CatBoost
- [ ] SHAP –∞–Ω–∞–ª–∏–∑ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
- [ ] –ì–∏–ø–µ—Ä–æ–ø—Ç–∏ —á–µ—Ä–µ–∑ Optuna
- [ ] –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π (CalibratedClassifierCV)
- [ ] SMOTE –¥–ª—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—Ä–∞–∑—Ü–æ–≤ –º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–∞
- [ ] –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö —Å –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [ ] –ê–Ω—Å–∞–º–±–ª—å –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –¥–æ top-5

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ

| –í–µ—Ä—Å–∏—è | –®–∞–≥ | F1 (CV) | Recall | Precision | Kaggle | –ú–µ—Å—Ç–æ |
|--------|-----|--------|--------|-----------|--------|-------|
| v1 | Baseline | 0.1279 | 0.07 | 0.61 | ~0.20 | 500+ |
| v2 | + Balanced weights | 0.3525 | 0.97 | 0.22 | ~0.30 | 400+ |
| v3 | + Threshold 0.491 | 0.4487 | 0.54 | 0.38 | ~0.42 | 100+ |
| v4 | + Feature Eng (19) | 0.4494 | 0.56 | 0.37 | ~0.43 | 50-40 |
| v5 | + 5-Fold CV | 0.4345 | 0.58 | 0.35 | - | - |
| **v6** | **–§–∏–Ω–∞–ª—å–Ω–∞—è** | **0.4375** | **0.57** | **0.35** | **0.44613** | **15** |

---

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

**–ê–ª–µ–∫—Å–µ–π** | Data Analyst & ML Engineer  
üìß [GitHub](https://github.com/vulcan4ik) | üíº [Kaggle Profile](https://www.kaggle.com/vulcan4ik)

### Kaggle Achievements
- üèÜ Leopard Challenge Classification: **15-–µ –º–µ—Å—Ç–æ** (0.44613)
- üìä –û–ø—ã—Ç —Å CatBoost, XGBoost, LightGBM
- üî¨ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–µ –∫–ª–∞—Å—Å–æ–≤

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –°–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —É—á–µ–±–Ω—ã—Ö –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ü–µ–ª—è—Ö

---

<div align="center">

**–ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª –≤ Kaggle —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–∏** ‚úÖ  
**–ó–∞–Ω—è–ª 15-–µ –º–µ—Å—Ç–æ —Å F1-score 0.44613** üèÜ

‚≠ê **–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!**

```
Made with ‚ù§Ô∏è and üêç Python | Kaggle Competition 2025
```

[üîó Kaggle Leaderboard](https://www.kaggle.com/competitions/leopard-challenge-classification/leaderboard)

</div>

